/*!
 * Spellnote
 * version: 1.0.0
 * author: yzt
 * Spellnote is built on jQuery.(https://github.com/jquery/jquery)
 * Icons are from Font Awesome.(https://github.com/FortAwesome/Font-Awesome)
 */
$.extend({spellnote:new function(){this.constant=function(){return{emptyPara:"<p><br></p>",topLevelTagNameList:["P","H1","H2","H3","H4","H5","H6","BLOCKQUOTE"],editorClassName:"sn-editor",colorUnitList:["#000000",'<span class="sn-unit-foreColor-preview" style="background-color: #000000;"></span>',"#FFFFFF",'<span class="sn-unit-foreColor-preview" style="background-color: #FFFFFF;"></span>',"#FF0000",'<span class="sn-unit-foreColor-preview" style="background-color: #FF0000;"></span>',"#FF9C00",'<span class="sn-unit-foreColor-preview" style="background-color: #FF9C00;"></span>',"#FFFF00",'<span class="sn-unit-foreColor-preview" style="background-color: #FFFF00;"></span>',"#00FF00",'<span class="sn-unit-foreColor-preview" style="background-color: #00FF00;"></span>',"#00FFFF",'<span class="sn-unit-foreColor-preview" style="background-color: #00FFFF;"></span>',"#0000FF",'<span class="sn-unit-foreColor-preview" style="background-color: #0000FF;"></span>',"#9C00FF",'<span class="sn-unit-foreColor-preview" style="background-color: #9C00FF;"></span>',"#CE0000",'<span class="sn-unit-foreColor-preview" style="background-color: #CE0000;"></span>',"#E79439",'<span class="sn-unit-foreColor-preview" style="background-color: #E79439;"></span>',"#EFC631",'<span class="sn-unit-foreColor-preview" style="background-color: #EFC631;"></span>',"#6BA54A",'<span class="sn-unit-foreColor-preview" style="background-color: #6BA54A;"></span>',"#4A7B8C",'<span class="sn-unit-foreColor-preview" style="background-color: #4A7B8C;"></span>',"#3984C6",'<span class="sn-unit-foreColor-preview" style="background-color: #3984C6;"></span>',"#634AA5",'<span class="sn-unit-foreColor-preview" style="background-color: #634AA5;"></span>',"#E79C9C",'<span class="sn-unit-foreColor-preview" style="background-color: #E79C9C;"></span>']}}(),this.snObjs=new Object,this.rangeBuffer=void 0,this.docScrollTop=void 0,this.tools=function(){return{indexOf:function(t,e){for(var n=0,s=t.length;n<s&&t[n]!==e;n++);return n>=s?-1:n},getRandomStr:function(t){var e="";t=t||8;for(var n=0;n<t;n++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"[Math.floor(51*Math.random())];return e},scrollToTop:function(t,e){e=e||300;var n=t.offset().top;$(window).height(),$("html,body").animate({scrollTop:n},e)}}}(),this.funcs=function(){var t=function(t){return t.find(".sn-unit")},e=function(t,e){return t.find(".sn-unit-name-"+e)},n=function(t){return t.find(".sn-unit-panel")},s=function(t){return t.find(".sn-editor")},i=function(t){return t.find(".sn-code-editor")},o=function(t){return(document.selection&&document.selection.createRange?document.selection:document.getSelection?document.getSelection():window.getSelection())||null},l=function(t){if(t)try{return new Range}catch(t){return e.createRange()}var e=this.createSelection();if(!e)return null;var n;return e.rangeCount>0&&(n=e.getRangeAt?e.getRangeAt(0):e.createRange()),n||null},a=function(t,e){var e=void 0==e?this.createRange():e},c=function(t,e){var e=void 0==e?null:e;document.execCommand(t,!1,e)},r=function(t,e){try{return document.queryCommandState(t)}catch(t){}},u=function(t,e){document.execCommand("styleWithCSS",!1,!0),e(t),document.execCommand("styleWithCSS",!1,!1)},d=function(t,e,n){var s;s=t.hasClass("sn-unit")?t:this.$getUnit(t,n);for(var n=s.data("name"),i=$.spellnote.units[n].statusList,o=0;o<i.length;o++)s.removeClass("sn-unit-status-"+i[o]);s.addClass("sn-unit-status-"+e)},p=function(t,e,n){var s;s=t.hasClass("sn-unit")?t:this.$getUnit(t,n);var i=s.data("status"),n=s.data("name"),o=$.spellnote.units[n],l=o.statusList,a=$.spellnote.tools.indexOf(l,e);return i==a||a>=0&&(s.data("status",a),this.switchUnitStatusClass(s,e),!0)},f=function(t){var e=$.spellnote.funcs.createRange(!0);if(t.childNodes.length<=0)return e.setEnd(t,0),e.setStart(t,0),e;var n,s=t.childNodes[t.childNodes.length-1],i=0;if(3==s.nodeType)n=s,i=n.length;else{var o=this.seekNodes(s,null,null,!0);o=h(o,{tagNames:["BR"]}),0==o.length?n=s:(n=o[o.length-1],-1==$.spellnote.tools.indexOf($.spellnote.constant.topLevelTagNameList,n.tagName)&&(n=3==n.nodeType?n:n.parentNode,i=3==n.nodeType?n.length:n.childNodes.length))}return e.setEnd(n,i),e.setStart(n,i),e},g=function(t){var e=$.spellnote.funcs.createRange();if(e.startContainer==t&&0==t.childNodes)return!0;var n=this.getRangeOfCursorAtLast(t);return!!this.isRangeEqual(e,n)},v=function(t,e,n,s){var i=t.childNodes,o=i.length,n=n||new Array;if(s&&(e&&i[l].nodeType!=e||n.push(t)),o>0)for(var l=0;l<o;l++)e&&i[l].nodeType!=e||n.push(i[l]),this.seekNodes(i[l],e,n);return n},h=function(t,e){for(var n=new Array,s=0;s<t.length;s++)e.tagNames&&t[s].tagName&&$.spellnote.tools.indexOf(e.tagNames,t[s].tagName)>-1||e.nodeTypes&&t[s].nodeType&&e.nodeTypes==t[s].nodeType||n.push(t[s]);return n},m=function(t,e){var n,s=$.spellnote.funcs.createSelection();if(-1==e)n=this.getRangeOfCursorAtLast(t);else{n=$.spellnote.funcs.createRange();var i=t.childNodes;n.setEnd(t,i.length),n.setStart(t,i.length)}s.removeAllRanges(),s.addRange(n)},C=function(){var t=this.createRange();$.spellnote.rangeBuffer=t},k=function(t){var e=this.createSelection();e.removeAllRanges(),!t&&$.spellnote.rangeBuffer&&(t=$.spellnote.rangeBuffer),t&&e.addRange(t)},b=function(t,e){var n=!1;if(e){for(var s=e.commonAncestorContainer;"HTML"!=s.tagName&&"sn-editor-panel"!=s.className;)s=s.parentNode;t[0]==s.parentNode&&(n=!0)}return n},y=function(t){var e=(this.$getEditor(t),this.createRange()),n=this.isRangeBelongTo(t,e);return n||(e=$.spellnote.rangeBuffer,n=this.isRangeBelongTo(t,e)),n||(e=this.getRangeOfCursorAtLast(t.find("."+$.spellnote.constant.editorClassName)[0])),e},T=function(t,e){var n=this.getRangeBelongTo(t);this.setRange(n),$.spellnote.funcs.executeCommand("insertHtml",e)},w=function(t,e){var n=this.getRangeBelongTo(t);this.setRange(n),n.insertNode(e)},x=function(t){var e;e=t.hasClass("sn-editor")?t:this.$getEditor(t);var n=e[0].childNodes;0==n.length&&this.insertHtml(t,$.spellnote.constant.emptyPara);for(var s=0;s<n.length;s++){var i=n[s],t=$(i);"BR"!=i.tagName?"DIV"!=i.tagName?!i.tagName||$.spellnote.tools.indexOf($.spellnote.constant.topLevelTagNameList,i.tagName)<0?t.wrap("<p>"):i.childNodes.length>1&&$(i).children("br").remove():t.replaceWith("<p>"+t.html()+"</p>"):(t.remove(),--s)}},S=function(t,e){return t.startContainer==e.startContainer&&t.startOffset==e.startOffset&&t.endContainer==e.endContainer&&t.endOffset==e.endOffset},F=function(t,e){this.saveRangeToBuffer(),$.spellnote.docScrollTop||($.spellnote.docScrollTop=$(document).scrollTop()),this.$getUnitPanel(t).css("top",0);var n=e.title||"Modal",s=e.contentHtml||"There is nothing.",i=e.buttonText||"OK",o=e.callback||function(){},l=(void 0!==e.autoClose&&e.autoClose,t.find(".sn-modal"));l.length>0&&(l.find(".sn-modal-button-bar").off(),l.find(".sn-modal-close-button").off(),l.slideUp(50,function(){l.remove()}));var a=$('<div class="sn-modal"></div>'),c=$('<div class="sn-modal-title">'+n+"</div>"),r=$('<div class="sn-modal-content">'+s+"</div>"),u=$('<div class="sn-modal-button-bar">'+i+"</div>"),d=$('<div class="sn-modal-close-button icon-cancel"></div>');d.on("click",function(){a.slideUp(50,function(){$(this).off(),u.off(),a.remove(),$.spellnote.enable(t),$(document).scrollTop($.spellnote.docScrollTop),$.spellnote.docScrollTop=void 0})}),u.on("click",function(){o(a,function(){d.click()})}),a.append(c).append(r).append(u).append(d),a.insertBefore(t.find(".sn-editor-panel")),$.spellnote.disable(t),a.slideDown(100),$.spellnote.tools.scrollToTop(t)},R=function(t,e,n,s,i){var o=t.find(".sn-tip");if(o.length>0&&(o.find(".sn-tip-close-button").off(),o.slideUp(200,function(){o.remove()})),e){s=void 0===s||s,i=i||5e3,n=n||"warning",e=e||"This is a tip!";var l=$('<div class="sn-tip"></div>'),a=$('<span class="sn-tip-icon icon-attention-circled"></span>');a.addClass(n);var c=$('<span class="sn-tip-content">'+e+"</span>"),r=$('<div class="sn-tip-close-button icon-cancel"></div>');l.append(a).append(c).append(r),r.on("click",function(){$(this).off(),l.slideUp(200,function(){l.remove()})}),l.insertAfter(t.find(".sn-unit-panel")),$.spellnote.tools.scrollToTop(t),l.slideDown(200),s&&setTimeout(function(){r.click()},i)}};return{$getUnits:t,$getUnit:e,$getUnitPanel:n,$getEditor:s,$getCodeEditor:i,getSnObj:function(t){var e=t.data("snid");return $.spellnote.snObjs[e]?$.spellnote.snObjs[e]:void 0},createSelection:o,createRange:l,isEditable:a,executeCommand:c,queryCommandState:r,switchUnitStatusClass:d,setUnitStatus:p,formatEditorHtml:x,setCursor:m,isRangeEqual:S,setRange:k,saveRangeToBuffer:C,insertNode:w,insertHtml:T,seekNodes:v,cleanNodes:h,isCursorAtLast:g,getRangeOfCursorAtLast:f,styleWithCSS:u,showModal:F,isRangeBelongTo:b,getRangeBelongTo:y,showTip:R}}(),this.units={},this.$initSingleUnit=function(t,e){var n,s,i=this;if(s=this.units[e],s.init?n=s.init():s.iconClass?(n=$('<button type="button">').addClass(s.iconClass),s.title&&n.attr("title",s.title)):n=$('<button type="button">').text(s.title),n.addClass("sn-unit").addClass("sn-unit-name-"+e).data("event","false"==s.listenEvent?"false":"true").data("type","unit").data("name",e).data("status",0),s.statusList&&s.statusList[0]&&n.addClass("sn-unit-status-"+s.statusList[0]),s.list){for(var o=$('<div class="sn-unit-expanding-list sn-unit-expanding-list-'+e+'" style="display: none;">'),l=0;l<s.list.length;l+=2){var a=$('<div class="sn-unit-expanding-list-item" data-value="'+s.list[l]+'">');a.html(s.list[l+1]),o.append(a),a.on("click",function(){$.spellnote.funcs.setRange($.spellnote.rangeBuffer),i.units[e].listClick(t,$(this).data("value"))})}if(o.children.length>0){t.append(o),n.addClass("sn-list-unit");var c=(o.outerHeight(),o.outerWidth());n.on("click",function(){$.spellnote.funcs.saveRangeToBuffer(),$(".sn-unit-expanding-list:not(.sn-unit-expanding-list-"+e+")").hide(),$(".sn-unit-list-active").removeClass("sn-unit-list-active");var t=$(".sn-unit-expanding-list-"+e);if(t.is(":hidden")){var s=$(this),i=s.offset();t.css({left:i.left,top:i.top+s.outerHeight()-$(document).scrollTop()+2}),n.addClass("sn-unit-list-active"),t.addClass("show"),t.slideDown(200);var o=t.offset();o.left<0?t.css("left",0):o.left+c>$(window).width()&&t.css("left",$(window).width()-c-5)}else t.slideUp(200),n.removeClass("sn-unit-list-active"),t.removeClass("show")})}}return n},this.unitsInit=function(t,e){for(var n=$('<div class="sn-unit-panel">'),s=0;s<e.length;s++)if("object"==typeof e[s]){for(var i=$("<div>").addClass("sn-units-group"),o=0;o<e[s].length;o++){var l=this.$initSingleUnit(t,e[s][o]);i.append(l)}n.append(i)}else{var l=this.$initSingleUnit(t,e[s]);n.append(l)}t.append(n),$(document).on("scroll click",function(t){$(t.target).hasClass("sn-unit-list-active")||($(".sn-unit-expanding-list.show").slideUp(200),$(".sn-unit-list-active").removeClass("sn-unit-list-active"))})},this.updateUnitsStatus=function(t){var e,n,s,i=this.funcs.$getUnits(t),o=this.units,l=this.funcs.createRange();i.each(function(){s=$(this).data("name"),n=o[s],n.checkStatus&&(e=n.checkStatus(l))&&$.spellnote.funcs.setUnitStatus(t,e,s)})},this.insertNode=function(t,e){$.spellnote.funcs.insertNode(t,e[1])},this.editorInit=function(t){var e=$('<div class="sn-editor-panel">'),n=$('<div class="sn-editor">').attr({contenteditable:!0,spellcheck:!1}),s=$('<pre class="sn-code-editor">').attr("contenteditable","true").hide();return n.html(this.constant.emptyPara),e.append(n).append(s),t.append(e),n.on("mouseup",function(e){e.stopPropagation(),$.spellnote.updateUnitsStatus(t)}).on("keyup",function(e){e.stopPropagation(),(13==e.keyCode||8==e.keyCode&&0==n[0].childNodes.length)&&$.spellnote.funcs.formatEditorHtml(t),(e.keyCode>=37&&e.keyCode<=40||13==e.keyCode||8==e.keyCode||e.shiftKey)&&$.spellnote.updateUnitsStatus(t)}).on("keydown",function(e){e.stopPropagation(),32==e.keyCode&&(e.preventDefault(),$.spellnote.funcs.insertHtml(t,"&nbsp;")),9==e.keyCode&&(e.preventDefault(),$.spellnote.funcs.insertHtml(t,"&nbsp;&nbsp;&nbsp;&nbsp;"))}).on("blur",function(t){t.stopPropagation()}),n},this.triggerEvent=function(t,e){var n=$(e.target);if("false"!==n.data("event")){var s=n.data("type"),i=n.data("name");if("unit"==s){var o=this.units[i].statusList;if(o&&o.length>0){var l=n.data("status"),a=(l+1)%o.length;if(!this.units[i][e.type+"_"+o[a]])return;this.units[i][e.type+"_"+o[a]](t,e),n.data("status",a),this.funcs.switchUnitStatusClass(n,o[a])}else this.units[i][e.type]&&this.units[i][e.type](t,e)}}},this.registeEventHandler=function(t){var e=this;t.on("click change",function(n){e.triggerEvent(t,n)})},this.init=function(t,e){var n=e[1],s=new Object;s.$node=t,s.rangeBuffer=void 0,s.callback=n.callback||new Object;var i=$.spellnote.tools.getRandomStr();t.data("snid",i),s.id=i,$.spellnote.snObjs[i]=s,this.unitsInit(t,n.units);var o=this.editorInit(t);if(this.registeEventHandler(t),t.css({position:"relative",maxWidth:n.maxWidth,width:n.width}),o.css({maxHeight:n.maxHeight,height:n.height}),n.cleanHtmlOnPaste&&o.on("paste",function(t){t.preventDefault?t.preventDefault():t.returnValue=!1;var e=((t.originalEvent||t).clipboardData||window.clipboardData).getData("Text/plain");document.execCommand("insertText",!1,e)}),n.unitsTracing){var s=$.spellnote.funcs.getSnObj(t),l=$.spellnote.funcs.$getUnitPanel(t);$(document).on("scroll click",function(e){s.unitsScrollTimeout&&(clearTimeout(s.unitsScrollTimeout),s.unitsScrollTimeout=void 0),s.unitsScrollTimeout=setTimeout(function(){var e=$.spellnote.funcs.createRange();if($.spellnote.funcs.isRangeBelongTo(t,e)){var n=t.offset().top,s=$(document).scrollTop();l.stop(),s>n?l.animate({top:s-n},200):l.animate({top:0},200)}else l.animate({top:0},200)},300)})}},this.enable=function(t){$.spellnote.funcs.$getEditor(t).attr("contenteditable","true")},this.disable=function(t){$.spellnote.funcs.$getEditor(t).attr("contenteditable","false")},this.html=function(t,e){var n=e.length>1?e[1]:void 0;if(!n)return $.spellnote.funcs.formatEditorHtml(t),$.spellnote.funcs.$getEditor(t).html();$.spellnote.funcs.$getEditor(t).html(n),$.spellnote.funcs.formatEditorHtml(t)},this.empty=function(t,e){$.spellnote.funcs.$getEditor(t).html($.spellnote.constant.emptyPara)},this.tip=function(t,e){var n="";if("string"==typeof e[1])n=e[1],$.spellnote.funcs.showTip(t,n);else{var s=e[1];n=s.content;var i=s.type,o=s.autoHide,l=s.duration;$.spellnote.funcs.showTip(t,n,i,o,l)}}}}),$.extend($.spellnote.units,function(){var t={title:"查看代码",iconClass:"icon-code",statusList:["deactive","active"],click_active:function(t){var e=$.spellnote.funcs.$getEditor(t),n=$.spellnote.funcs.$getCodeEditor(t);n.text(e.html()),e.slideUp(100,function(){n.slideDown(300),$.spellnote.tools.scrollToTop(t)})},click_deactive:function(t){var e=$.spellnote.funcs.$getEditor(t),n=$.spellnote.funcs.$getCodeEditor(t);e.html(n.text()),n.slideUp(100,function(){e.slideDown(300)})}},e={title:"加粗",iconClass:"icon-bold",statusList:["deactive","active"],click_active:function(t){$.spellnote.funcs.executeCommand("bold")},click_deactive:function(t){$.spellnote.funcs.executeCommand("bold")},checkStatus:function(){return $.spellnote.funcs.queryCommandState("bold")?"active":"deactive"}},n={title:"斜体",iconClass:"icon-italic",statusList:["deactive","active"],click_active:function(t){$.spellnote.funcs.executeCommand("italic")},click_deactive:function(t){$.spellnote.funcs.executeCommand("italic")},checkStatus:function(){return $.spellnote.funcs.queryCommandState("italic")?"active":"deactive"}},s={title:"下划线",iconClass:"icon-underline",statusList:["deactive","active"],click_active:function(t){$.spellnote.funcs.executeCommand("underline")},click_deactive:function(t){$.spellnote.funcs.executeCommand("underline")},checkStatus:function(){return $.spellnote.funcs.queryCommandState("underline")?"active":"deactive"}},i={title:"删除线",iconClass:"icon-strike",statusList:["deactive","active"],click_active:function(t){$.spellnote.funcs.executeCommand("strikeThrough")},click_deactive:function(t){$.spellnote.funcs.executeCommand("strikeThrough")},checkStatus:function(){return $.spellnote.funcs.queryCommandState("strikeThrough")?"active":"deactive"}},o={title:"清除样式",iconClass:"icon-eraser",click:function(t){$.spellnote.funcs.executeCommand("removeFormat"),$.spellnote.updateUnitsStatus(t)}},l={title:"撤销",iconClass:"icon-ccw",click:function(t){$.spellnote.funcs.executeCommand("undo"),$.spellnote.updateUnitsStatus(t)}},a={title:"重做",iconClass:"icon-cw",click:function(t){$.spellnote.funcs.executeCommand("redo"),$.spellnote.updateUnitsStatus(t)}},c={title:"字体大小",iconClass:"icon-text-height",list:[1,'<font size="1">Aa</font>',2,'<font size="2">Aa</font>',3,'<font size="3">Aa<span style="font-size: 12px;">(默认)<span></font>',4,'<font size="4">Aa</font>',5,'<font size="5">Aa</font>',6,'<font size="6">Aa</font>',7,'<font size="7">Aa</font>'],listClick:function(t,e){$.spellnote.funcs.executeCommand("fontSize",parseInt(e))}},r={title:"字体颜色",iconClass:"icon-font",list:$.spellnote.constant.colorUnitList,listClick:function(t,e){$.spellnote.funcs.executeCommand("foreColor",e)}},u={title:"背景颜色",iconClass:"icon-font-reverse",list:$.spellnote.constant.colorUnitList,listClick:function(t,e){$.spellnote.funcs.executeCommand("backColor",e)}},d={title:"插入视频",iconClass:"icon-video",click:function(t,e){$.spellnote.funcs.showModal(t,{title:"插入视频",contentHtml:'<div><p>视频链接:<p><input class="sn-input sn-video-input" type="text" /></div><p>请输入视频的网址，目前仅支持bilibili视频。</p>',buttonText:"确认",callback:function(e,n){var s,i=e.find(".sn-video-input").val(),o=/bilibili.com\/video\/av([0-9]+)(\/index_([0-9]+).html)?/,l=i.match(o);l?s=$("<iframe>").attr("src","http://player.bilibili.com/player.html?aid="+l[1]+"&page="+(void 0==l[3]?"1":l[3])).attr({height:415,width:544,frameborder:"no",scrolling:"no",border:"0",framespacing:"0",allowfullscreen:"true"}):$.spellnote.funcs.showTip(t,"链接不正确！"),s&&(s.addClass("sn-v"),$.spellnote.funcs.insertNode(t,s[0]),n())}})}},p={title:"插入音乐",iconClass:"icon-music",click:function(t,e){$.spellnote.funcs.showModal(t,{title:"插入音乐",contentHtml:'<div><p>音乐链接:<p><input class="sn-input sn-music-input" type="text" /></div><p>请输入音乐的网址，目前仅支持网易云音乐。</p>',buttonText:"确认",callback:function(e,n){var s,i=e.find(".sn-music-input").val(),o=/music.163.com.*song\?id=(\d+)/,l=i.match(o);l?s=$("<iframe>").attr("src","http://music.163.com/outchain/player?type=2&id="+l[1]+"&auto=0&height=66").attr({height:86,width:330,frameborder:"no"}):$.spellnote.funcs.showTip(t,"链接不正确！"),s&&(s.addClass("sn-m"),$.spellnote.funcs.insertNode(t,s[0]),n())}})}},f={title:"插入图片",iconClass:"icon-picture",click:function(t,e){$.spellnote.funcs.showModal(t,{title:"插入图片",contentHtml:'<div><p>从本地选择图片:<p><input class="sn-input sn-image-input" type="file" name="files" accept="image/jpg,image/jpeg,image/gif,image/bmp,image/png" /></div>',buttonText:"确认",callback:function(e,n){var s=e.find(".sn-image-input")[0].files[0],i=$.spellnote.funcs.getSnObj(t);i.callback.onImageUpload?i.callback.onImageUpload(s,n):n()}})}},g={title:"插入链接",iconClass:"icon-link",click:function(t,e){$.spellnote.funcs.showModal(t,{title:"插入链接",contentHtml:'<div><p>链接文本:<p><input class="sn-input sn-link-text-input" type="text" /><p>链接地址:</p><input class="sn-input sn-link-href-input" type="text" /></div>',buttonText:"确认",callback:function(e,n){var s=e.find(".sn-link-text-input").val(),i=e.find(".sn-link-href-input").val();if(/^https?:(\/{2}|\\)/.test(i)?/^https?:(\/{2}|\\)$/.test(i)&&(i=""):""!=i&&(i="http://"+i),""==i)return void $.spellnote.funcs.showTip(t,"链接地址不能为空！");""==s&&""!=i&&(s=i);var o=$.spellnote.funcs.getSnObj(t);if(o.callback.onLinkInsert)o.callback.onLinkInsert(s,i);else{var l=$('<a class="sn-l" href="'+i+'">'+s+"</a>");$.spellnote.funcs.insertNode(t,l[0])}n()}})}},v={title:"移除链接",iconClass:"icon-unlink",click:function(t,e){$.spellnote.funcs.executeCommand("unlink")}},h={title:"段落居左",iconClass:"icon-align-left",click:function(t,e){$.spellnote.funcs.executeCommand("justifyLeft")}},m={title:"段落居中",iconClass:"icon-align-center",click:function(t,e){$.spellnote.funcs.executeCommand("justifyCenter")}},C={title:"段落居右",iconClass:"icon-align-right",click:function(t,e){$.spellnote.funcs.executeCommand("justifyRight")}},k={title:"关于",iconClass:"icon-help",click:function(t,e){$.spellnote.funcs.showModal(t,{title:"关于 Spellnote",contentHtml:'<p><span style="font-size: 20px;">SPELLNOTE <span style="font-size: 12px;">v1.0-beta</span></span> <span style="margin-left: 10px; font-size: 14px;">作者: 月之庭</span></p><p>Spellnote是一款轻量级富文本编辑器，它的诞生是为了使某些扩展变得更加简单。<p><p>建议使用Chrome或Firefox浏览器以获得最佳体验！</p><p>感谢 jQuery 与 Font Awesome 为Spellnote提供的便利！</p><p>若有意见、建议或BUG反馈，请发信至 lovenekomusume@163.com，谢谢！</p>',buttonText:"继续使用 Spellnote",callback:function(t,e){e()}})}};return{test:{title:"test",click:function(t,e){$.spellnote.funcs.showTip(t,"error")}},about:k,code:t,bold:e,italic:n,underline:s,strikeThrough:i,redo:a,undo:l,fontSize:c,foreColor:r,backColor:u,removeFormat:o,video:d,music:p,image:f,link:g,unlink:v,alignLeft:h,alignCenter:m,alignRight:C}}()),$.fn.extend({spellnote:function(){var t=$(this);return $.spellnote[arguments[0]](t,arguments)}});